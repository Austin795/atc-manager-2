webpackJsonp([4],{"Cji+":function(){},F0LX:function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var w=n("EBst"),m=(n("OPYc"),n("VFww")),b=(n("jyJ7"),n("eSoh"),n("vzCy")),v=function(e){function t(){var t=r(this,e.call(this));return t.loadByIcao=function(e){return new Promise(function(n,r){var o,a,i,s;return t.loaded=!1,Promise.resolve(Promise.all([m.a.fetchAptByIcao(e),m.a.searchAptNavIcao(e)])).then(function(e){try{return o=e,a=o[0],i=o[1],s=i[0].split(" "),t.aptNav={icao:s[0],lat:s[1],lng:s[2],name:s.slice(3).join(" ")},t.apt=a,t.loaded=!1,t.emit("change"),n()}catch(e){return r(e)}},r)})},t.aptNav=null,t.apt=null,t.loaded=!1,t}return o(t,e),t}(b.EventEmitter),j=new v,x=n("5Iuc"),k=(n("Cji+"),function(e,t){return e*=.0174532925,t*=.0174532925,[111132.954-559.822*Math.cos(2*t)+1.175*Math.cos(4*t),111132.954*Math.cos(e)]}),O=function(e){function t(n){a(this,t);var r=i(this,e.call(this));return r.componentDidUpdate=function(){r.props.loaded!==r.state.loaded&&r.setState({loaded:!0},r.setGroundGameStoreData)},r.setGroundGameStoreData=function(){var e=j.apt;if(!1!==r.state.loaded){var t=[j.aptNav.lat,j.aptNav.lng],n=k(t[0],t[1]),o=[t[0]*n[0],t[1]*n[1]],a=e.taxiRoutingNetwork.nodes.map(function(e){return{identifier:e.identifier,lat:e.lat,lng:e.lng,x:n[1]*e.lng-o[1],y:n[0]*e.lat-o[0]}});console.log(n);var i=e.rwys.map(function(e){return{x1:n[1]*e.ends[0].lng-o[1],y1:n[0]*e.ends[0].lat-o[0],x2:n[1]*e.ends[1].lng-o[1],y2:n[0]*e.ends[1].lat-o[0]}}),s={minX:Math.min.apply(Math,a.map(function(e){return e.x})),maxX:Math.max.apply(Math,a.map(function(e){return e.x})),minY:Math.min.apply(Math,a.map(function(e){return e.y})),maxY:Math.max.apply(Math,a.map(function(e){return e.y}))},c=s.minX,u=s.maxX,l=s.minY,p=s.maxY,d=x.a.groundPixelPadding,f=u-c,h=p-l,y=Math.max(f,h),g=Math.min(x.a.width,x.a.height);r.getX=function(e){return(e.x-c)/y*(g-2*d)+d},r.getY=function(e){return g-(e.y-l)/y*(g-2*d)-d};var w=e.taxiRoutingNetwork.edges.map(function(e){return{identifier:e.identifier,end:a.find(function(t){return t.identifier===e.end}),start:a.find(function(t){return t.identifier===e.start}),twoway:e.twoway,runway:e.twoway}});w.push.apply(w,e.taxiRoutingNetwork.edges.map(function(e){return{identifier:e.identifier,start:a.find(function(t){return t.identifier===e.end}),end:a.find(function(t){return t.identifier===e.start}),twoway:e.twoway,runway:e.twoway}}));var m=function(e,t){return Math.pow(Math.abs(e.x-t.x),2)+Math.pow(Math.abs(e.y-t.y),2)};w.forEach(function(e){return e.cost=Math.sqrt(m(e.start,e.end))}),w.forEach(function(e){return e.costSq=m(e.start,e.end)}),a.forEach(function(e){return e.edges=w.filter(function(t){return t.start===e})}),r.setState({runwaysXY:i,nodes:a,edges:w,midFromNodes:s})}},r.handleGroundGameStoreChange=function(){r.setState({}),r.props.loaded&&r.setGroundGameStoreData()},r.state={loaded:n.loaded},n.loaded&&r.setGroundGameStoreData(),r}return s(t,e),t.prototype.componentWillMount=function(){j.on("change",this.handleGroundGameStoreChange)},t.prototype.componentWillUnmount=function(){j.removeListener("change",this.handleGroundGameStoreChange)},t.prototype.render=function(){if(this.state.loaded){var e=this.state,t=e.nodes,n=e.edges,r=this.getX,o=this.getY,a=this.state.runwaysXY.map(function(e,t){var n=e.x1,a=e.y1,i=e.x2,s=e.y2;return console.log(n,a,i,s),Object(w.h)("line",{key:t,x1:r({x:n,y:a}),y1:o({x:n,y:a}),x2:r({x:i,y:s}),y2:o({x:i,y:s}),stroke:"#fff",strokeWidth:"2"})}),i=t.map(function(e,t){return Object(w.h)("circle",{className:"ground-taxi-nodes",key:t,cx:r(e),cy:o(e),r:"2"})}),s=n.map(function(e,t){return Object(w.h)("line",{className:"ground-taxi-edges",key:t,x1:r(e.start),y1:o(e.start),x2:r(e.end),y2:o(e.end)})});return Object(w.h)("g",{className:"GroundRunwaysSvg"},a,i,s)}},t}(w.Component),P=O,S=function(e){function t(){c(this,t);var n=u(this,e.call(this));return n.handleGroundGameStoreChange=function(){n.setState({})},n.setRef=function(e){return n.svgRef=e},n.state={},n}return l(t,e),t.prototype.componentWillMount=function(){j.on("change",this.handleGroundGameStoreChange)},t.prototype.componentWillUnmount=function(){j.removeListener("change",this.handleGroundGameStoreChange)},t.prototype.render=function(){var e="undefined"!=typeof window?window.innerWidth:800,t="undefined"!=typeof window?window.innerHeight:600;return Object(w.h)("div",{className:"GroundRadarSvg"},Object(w.h)("svg",{ref:this.setRef,xmlns:"http://www.w3.org/2000/svg",className:"atc-view-svg",width:e,height:t,viewBox:"0 0 1280 720"},Object(w.h)("style",null,"\n.ground-taxi-nodes {\n  stroke: green;\n}\n.ground-taxi-edges {\n  stroke: green;\n}"),Object(w.h)(P,{loaded:this.props.loaded,latLngToXY:this.props.latLngToXY})))},t}(w.Component),_=S,E=function(e){function t(){p(this,t);var n=d(this,e.call(this));return n.state={},n}return f(t,e),t.prototype.componentWillMount=function(){},t.prototype.componentWillUnmount=function(){},t.prototype.render=function(){return Object(w.h)("div",{className:"GroundAptView"},Object(w.h)(_,{loaded:this.props.loaded,latLngToXY:this.props.latLngToXY}))},t}(w.Component),M=E,G=function(e){function t(){h(this,t);var n=y(this,e.call(this));return n.getAptByIcao=function(e){return new Promise(function(t,r){var o,a,i,s,c;return n.setState({loaded:!1}),n.latLngToXY=null,Promise.resolve(j.loadByIcao(e)).then(function(){try{return o=j.apt,a=j.aptNav,i=k(a.lat,a.lng),s=i[0],c=i[1],n.latLngToXY=function(e,t){return[(e-a.lat)*s,(t-a.lng)*c]},n.setState({apt:o,aptNav:a,loaded:!0}),t()}catch(e){return r(e)}},r)})},n.state={loaded:!1},n}return g(t,e),t.prototype.componentWillMount=function(){this.getAptByIcao("KBFI")},t.prototype.componentWillUnmount=function(){},t.prototype.render=function(){return Object(w.h)("div",{className:"GroundGame"},Object(w.h)(M,{loaded:this.state.loaded,latLngToXY:this.latLngToXY}))},t}(w.Component);t.default=G},OPYc:function(){},VFww:function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n("vzCy"),i=n("LXEu"),s=function(e,t){var n;e=e.split(/\r?\n/),t||(e=e.slice(3,-2));for(var r=[],o=void 0,a=void 0,i=void 0,s=void 0,c=void 0,u=void 0,l=void 0,p=void 0,d=void 0,f=void 0,h=void 0,y=void 0,g=0;g<e.length;g++)if(""!==e[g].trim()){var w=e[g].split("#")[0].split(/\s+/),m=+w[0];switch(m){case 1:case 16:case 17:o={},o.type=m,o.elevation=+w[1],o.hasTower="1"===w[2],o.identifier=w[4],o.name=w.slice(5).join(" "),o.rwys=[],o.helipads=[],o.taxiways=[],o.linearFeatures=[],o.aptBoundaries=[],o.viewpoints=[],o.startupLocations=[],o.startupLocationsLegacy=[],o.lightBeacons=[],o.windsocks=[],o.signs=[],o.lightingObjects=[],o.trafficFlowRules=[],o.metadata=[],o.truckParkings=[],o.truckDestinations=[],o.atc={recorded:[],unicom:[],cld:[],gnd:[],twr:[],app:[],dep:[]},r.push(o);break;case 100:a={},a.type=m,a.width=+w[1],a.surface=+w[2],a.shoulder=+w[3],a.smoothness=+w[4],a.centrelinelights="1"===w[5],a.edgeLighting="2"===w[6],a.autoGenerateDistanceRemainingSigns="1"===w[7],a.ends=[];for(var b=8;w[b];b+=9){var v={};a.ends.push(v),v.name=w[b],v.lat=+w[b+1],v.lng=+w[b+2],v.displacedThresholdInMeters=w[b+3],v.lengthOverrunOrBlastPadInMeters=w[b+4],v.runwayMarkings=+w[b+5],v.approachLighting=+w[b+6],v.tdz="1"===w[b+7],v.reil=+w[b+8]}o.rwys.push(a);break;case 101:a={},a.type=m,a.type="searwy",a.width=w[1],a.buoys="1"===w[2],a.ends=[];for(var j=3;w[j];j+=3){var x={};a.ends.push(x),x.name=w[j],x.lat=+w[j+1],x.lng=+w[j+2]}o.rwys.push(a);break;case 102:i={},i.type=m,i.designator=w[1],i.lat=+w[2],i.lng=+w[3],i.orientation=+w[4],i.length=+w[5],i.width=+w[6],i.surface=+w[7],i.markings=+w[8],i.shoulder=+w[9],i.smoothness=+w[10],i.edgeLighting="2"===w[11],o.helipads.push(i);break;case 110:s={},s.type=m,s.surface=+w[1],s.smoothness=+w[2],s.orientation=+w[3],s.description=w.slice(4).join(" "),s.nodes=[],o.taxiways.push(s);break;case 120:s={},s.type=m,s.description=w.slice(1).join(" "),s.nodes=[],o.linearFeatures.push(s);break;case 130:s={},s.type=m,s.description=w.slice(1).join(" "),s.nodes=[],o.aptBoundaries.push(s);break;case 111:case 112:case 113:case 114:case 115:case 116:y={},y.type=m,y.lat=+w[1],y.lng=+w[2],112!==m&&114!==m&&116!==m||(y.bezierLat=+w[3],y.bezierLng=+w[4]),115===m?(y.line=+w[3],y.lighting=+w[4]):116===m&&(y.line=+w[3],y.lighting=+w[4]),s.nodes.push(y);break;case 14:var k={};k.type=m,k.lat=+w[1],k.lng=+w[2],k.height=+w[3],k.name=w.slice(5).join(" "),o.viewpoints.push(k);break;case 15:var O={};O.type=m,O.lat=+w[1],O.lng=+w[2],O.heading=+w[3],O.name=w.slice(4).join(" "),o.startupLocationsLegacy.push(O);break;case 18:u={},u.type=m,u.lat=+w[1],u.lng=+w[2],u.color=+w[3],o.lightBeacons.push(u);break;case 19:l={},l.type=m,l.lat=+w[1],l.lng=+w[2],l.lighting="1"===w[3],l.name=w.slice(4).join(" "),o.windsocks.push(l);break;case 20:p={},p.type=m,p.lat=+w[1],p.lng=+w[2],p.orientation=+w[3],p.size=+w[5],p.text=w.slice(6).join(" "),o.signs.push(p);break;case 21:d={},d.type=m,d.lat=+w[1],d.lng=+w[2],d.lighting=+w[3],d.orientation=+w[4],d.glideslope=+w[5],d.runway=w[6],d.description=w.slice(7).join(" "),o.lightingObjects.push(d);break;case 1e3:f={},f.type=m,f.name=w.slice(1).join(" "),f.wind=[],f.ceiling=[],f.time=[],f.runways=[],f.vfrPatterns=[],o.trafficFlowRules.push(f);break;case 1001:var P={type:m,metar:w[1],min:+w[2],max:+w[3],windMax:+w[4]};f.wind.push(P);break;case 1002:var S={type:m,metar:w[1],minCeiling:+w[2]};f.ceiling=S;break;case 1003:var _={type:m,metar:w[1],visibility:+w[2]};f.visibility=_;break;case 1004:var E={type:m,start:+w[1],end:+w[2]};f.time=E;break;case 1100:var M=(n={type:m,name:w[1],frequency:w[2].slice(0,-2)+"."+w[2].slice(-2),trafficType:w[3],airplaneTypes:w[4].split("|"),headingRange:w[5],departureHeadingRange:w[6]},n.name=w.slice(7),n);f.runways.push(M);break;case 1101:var G={type:m,name:w[1],direction:w[2]};f.vfrPatterns.push(G);break;case 1200:o.taxiRoutingNetwork={type:m,nodes:[],edges:[],groundVehicleEdges:[]};break;case 1201:o.taxiRoutingNetwork.nodes.push({type:m,lat:+w[1],lng:+w[2],usage:w[3],identifier:+w[4],name:w.slice(5).join(" ")});break;case 1202:h={type:m,start:+w[1],end:+w[2],twoway:"twoway"===w[3],runway:"runway"===w[4],identifier:w.slice(5).join(" ")},o.taxiRoutingNetwork.edges.push(h);break;case 1204:h.activeZone={type:m,classification:w[1],runways:w.slice(2).join("").split(",")};break;case 1206:h={type:m,start:+w[1],end:+w[2],twoway:"twoway"===w[3]},o.taxiRoutingNetwork.groundVehicleEdges.push(h);break;case 1300:c={type:m,lat:+w[1],lng:+w[2],heading:+w[3],locationType:w[4],airplaneTypes:w[5].split("|"),name:w.slice(6).join(" "),metadata:[]},o.startupLocations.push(c);break;case 1301:c.metadata.push({type:m,code:w[1],operation:w[2],airline:w.slice(3)});break;case 1302:o.metadata.push({type:m,code:w[1],icao:w[2]});break;case 1400:o.truckParkings.push({type:m,lat:+w[1],lng:+w[2],heading:+w[3],parkingType:w[4],code:w[5],name:w.slice(6).join(" ")});break;case 50:case 51:case 52:case 53:case 54:case 55:case 56:var T={type:m,frequency:w[1].slice(0,-2)+"."+w[1].slice(-2),name:w.slice(2).join(" ")};o.atc[["recorded","unicom","cld","gnd","twr","app","dep"][m-50]].push(T)}}return r},c=function(e){function t(){var t=r(this,e.call(this));t.handleDataloaded=function(e){return t.loading=!1,t.emit("change"),e},t.searchAptNavIcao=function(e){return e=e.toUpperCase(),t.datPromise.then(function(t){var n=t[0];return n.split("\n").filter(function(t){return t.split(" ")[0].includes(e)})})},t.searchAptName=function(e){return t.datPromise.then(function(t){var n=t[0];return n.split("\n").filter(function(t){return t.split(" ").slice(3).join(" ").includes(e)})})},t.fetchAptByIcao=function(e){return new Promise(function(n,r){var o,a;return e=e.toUpperCase(),Promise.resolve(fetch(t.url+"airports/"+e+".dat.txt")).then(function(e){try{return o=e,Promise.resolve(o.text()).then(function(e){try{return a=e,n(s(a,!0)[0])}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)})};var n=t.url="https://esstudio.site/apt-dat-parser-js/data/";t.loading=!0;var o=fetch(n+"apt_nav.dat.txt").then(function(e){return e.text()}),a=fetch(n+"earth_fix.dat.txt").then(function(e){return e.text()}),c=fetch(n+"earth_nav.dat.txt").then(function(e){return e.text()});return t.datPromise=Promise.all([o,a,c]).then(t.handleDataloaded).catch(function(e){Object(i.b)("Something wen't wrong while loading world data."),console.error(e)}),t}return o(t,e),t}(a.EventEmitter);t.a=new c},eSoh:function(){},jyJ7:function(){}});